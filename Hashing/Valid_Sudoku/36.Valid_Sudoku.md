# ğŸ”¹ Problem Name: 36. Valid Sudoku (Matrix / Constraint Checking, Medium)

**ğŸ”— Link:** [36. Valid Sudoku](https://leetcode.com/problems/valid-sudoku/)
**ğŸŸ¢ Status:** âœ… Solved

---

## ğŸ”¹Quick Breakdown

* **Difficulty Level:** Medium
* **Main Approach:** Single-pass **set-based deduplication** across rows, columns, and 3Ã—3 boxes
* **Core Concept:** **Bitmasking / HashSet** for constant-time membership checks
* **When to Use This Pattern?**

  * Validate partial Sudoku states without solving.
  * Any grid problem where **each region must contain unique symbols** (rows/cols/blocks).
* **Mistakes to Avoid:**

  1. Treating `'.'` as a number (must be skipped).
  2. Wrong box mapping (use `(r//3, c//3)` or `(r//3)*3 + (c//3)`).
  3. Running three separate passes instead of a **single pass with early exit**.
  4. Using lists for membership checks instead of sets/bitmasks.
  5. Thinking you must **solve** Sudokuâ€”this problem is **validation only**.

---

## ğŸ”¹ Optimization Path

* **Brute Force:** Check all 27 units (9 rows, 9 cols, 9 boxes) by scanning each and confirming no duplicates.

  * **Time:** O(81) (fixed 9Ã—9)
  * **Space:** O(1) (bounded counters)
* **Optimized Solution (Chosen):** **Single-pass** scan; for each digit at (r,c), check 3 buckets (row r, col c, box id) using sets. Early exit on first violation.

  * **Time:** O(81)
  * **Space:** O(1) (27 small sets)
* **Further Improvements Possible?**

  * Replace sets with **bitmasks** (3Ã—9 integers) for tighter memory and speed.
  * Use 3Ã—9Ã—9 **boolean arrays** if preferred for clarity.

---

## ğŸ”¹ Solution Breakdown

* **Optimal Approach:** Maintain three collections: `rows[9]`, `cols[9]`, `boxes[9]`. On each filled cell, reject if digit already seen in any of the three; otherwise record it.
* **Why This Works?** The Sudoku rules are exactly â€œno duplicates per row/column/box.â€ Local checks per cell enforce global validity.
* **Edge Cases Considered:**

  * Dots `'.'` (empty) are ignored.
  * Multiple duplicates anywhere â‡’ immediately invalid.
  * Correct 3Ã—3 mapping via `(r//3, c//3)` or compressed id `(r//3)*3 + (c//3)`.

---

## ğŸ”¹ Pattern Recognition

* **Belongs To:** **Pattern #15 â€” Backtracking / Branch-&-Bound / Bitmasking â†’ Bitmasking subpattern** (also **Hashing / Set-based Dedup**).
* **Common Problems Using This:**

  * LC 37 Sudoku Solver (same board, but **Backtracking**)
  * Latin square validation
  * Any â€œunique symbols in regionsâ€ grid tasks

---

## ğŸ”¹ Tricks & Patterns Used

* **Tuple-based box key**: `(r//3, c//3)` is intuitive and hashable.
* **Early termination** on first conflict.
* **`defaultdict(set)`** for terse, clean initialization (or prebuilt `rows = [set()]*9` with careâ€”avoid aliasing!).

---

## ğŸ”¹ Alternative Data Structures

* **Bitmasks**: 3 arrays of 9 integers; set/check bit `1 << (d-1)`.
* **Boolean arrays**: `rows[9][9]`, `cols[9][9]`, `boxes[9][9]` with `True/False` flags.

---

## ğŸ”¹ Complexity Analysis

* **Time Complexity:** **O(81)** (fixed board size â‡’ effectively O(1)).
* **Space Complexity:** **O(1)** (27 bounded sets or ints).

---

## ğŸ”¹ Code Snippet (Optimized â€” Set-Based)

```python
# Time: O(81) ~ O(1) for fixed 9x9
# Space: O(1) using 27 bounded sets
from typing import List
from collections import defaultdict

class Solution:
    def isValidSudoku(self, board: List[List[str]]) -> bool:
        # Track seen numbers for rows, columns, and boxes
        rows = defaultdict(set)
        cols = defaultdict(set)
        boxes = defaultdict(set)  # key: (r//3, c//3)

        for r in range(9):
            for c in range(9):
                ch = board[r][c]
                if ch == '.':
                    continue

                box_id = (r // 3, c // 3)
                # Duplicate found in any constraint â‡’ invalid
                if ch in rows[r] or ch in cols[c] or ch in boxes[box_id]:
                    return False

                # Record digit in all three constraints
                rows[r].add(ch)
                cols[c].add(ch)
                boxes[box_id].add(ch)

        return True
```

---

## ğŸ”¹ 80/20 Recall (8ty)

* **Three buckets** (row, col, box), **single pass**, **early exit**.
* Box id: `(r//3, c//3)`; ignore `'.'`.
* Bitmask is a drop-in alternative if you want extra speed.
